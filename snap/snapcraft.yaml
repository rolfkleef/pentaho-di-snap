name: pentaho-data-integration-spicule
version: '8.0'
summary: Data Integration Server
description: |
    Data Integration Server which allows users to ingest data into a variety
    of platforms via a GUI for CLI.

grade: devel
confinement: devmode

apps:
  spoon:
    command: desktop-launch $SNAP/data-integration/spoon.sh
    plugs: [network, network-bind,x11,home]

parts:
  data-integration:
    plugin: x_maven
    source: https://github.com/pentaho/pentaho-kettle.git
    source-type: git
    source-branch: 8.0.0.0
    maven-options: [-DskipTests]
    stage-packages: ["unzip"]
    build-packages: ["libwebkitgtk-1.0-0"]
    install: |
        unzip $SNAPCRAFT_PART_INSTALL/zip/pdi-ce-8.0-SNAPSHOT.zip -d $SNAPCRAFT_PART_INSTALL/
        rm -rf $SNAPCRAFT_PART_INSTALL/zip/pdi-ce-8.0-SNAPSHOT.zip
    after: [desktop-gtk3]
